const PLAYER = OBJ_EVENT_ID_PLAYER
const PSFTRANSRIVAL = 1
const PSFGOODADMIN = 2
const PSFGOODBOSS = 3
const PSFNATIVERIVAL = 4
const PKMNA = 5
const PKMNB = 6

script WhyAreYouHelpingThem_HideObject_Script {
    setflag(FLAG_HIDE_WHYAREYOU_NATIVERIVAL)
}

script WhyAreYouHelpingThem_MoveObject_Script {
    setobjectxy(PSFTRANSRIVAL,2,16)
    setobjectxyperm(PSFTRANSRIVAL,2,16)
}

script WhyAreYouHelpingThem_MoveObjectBoss_Script {
    setobjectxy(PSFTRANSRIVAL,2,16)
    setobjectxyperm(PSFTRANSRIVAL,2,16)
    setobjectxy(PSFGOODBOSS,7,3)
    setobjectxyperm(PSFGOODBOSS,7,3)
}

script WhyAreYouHelpingThem_MoveObjectPsfgoodadmin_Script {
    setflag(FLAG_HIDE_WHYAREYOU_PKMN)
    setobjectxy(PSFGOODADMIN,1,10)
    setobjectxyperm(PSFGOODADMIN,1,10)
}

script WhyAreYouHelpingThem_BlowHoleWall {
    setmetatile(13,1,0x3C8,FALSE)
    special(DrawWholeMapView)
}

script WhyAreYouHelpingThem_StartRaid {

    lockall
        setvar(VAR_ROUTE118_STATE,1)

playse(SE_FAILURE)
playse(SE_FAILURE)
playse(SE_FAILURE)
playse(SE_FAILURE)
applymovement(PSFTRANSRIVAL,Common_Movement_FaceDown)
applymovement(7,WhyAreYouHelpingThem_PoliceRunIn)
applymovement(8,WhyAreYouHelpingThem_PoliceRunIn)
applymovement(9,WhyAreYouHelpingThem_PoliceRunIn)
waitmovement(0)
msgbox(gText_WhyAreYouHelpingThem_StructuralBreach,MSGBOX_AUTOCLOSE)
waitmovement(0)

setvar(VAR_0x8000, MUGSHOT_BIANCA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_DefenseMode)

setvar(VAR_0x8000, MUGSHOT_HILDA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_WeShouldRedefine)

setvar(VAR_0x8000, MUGSHOT_BIANCA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_LetsSplitUp)

setvar(VAR_0x8000, MUGSHOT_HILDA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_WhaFineIllTry)

setvar(VAR_0x8000, MUGSHOT_BIANCA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_SeeYa)
callnative(ClearMugshot)
closemessage

applymovement(PSFTRANSRIVAL,WhyAreYouHelpingThem_PoliceRunIn)
waitmovement(0)
removeobject(7)
removeobject(8)
removeobject(9)
call(WhyAreYouHelpingThem_MoveObject_Script)
releaseall
end
}

script WhyAreYouHelpingThem_WitnessBattle {
setvar(VAR_ROUTE118_STATE,2)
lockall
applymovement(PSFGOODBOSS,WhyAreYouHelpingThem_FleeTheBattle)
waitmovement(0)
call(WhyAreYouHelpingThem_MoveObjectBoss_Script)

setvar(VAR_0x8000, MUGSHOT_BIANCA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_GoAfterIllHold)
callnative(ClearMugshot)
closemessage
releaseall
end
}


script WhyAreYouHelpingThem_PreBattleBoss_Script {
    setvar(VAR_ROUTE118_STATE,3)
    lockall
applymovement(PLAYER,WhyAreYouHelpingThem_ApproachPsfgoodboss)
applymovement(PSFGOODBOSS,Common_Movement_FaceLeft)
waitmovement(0)
setvar(VAR_0x8000, MUGSHOT_GIOVANNI)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_ItsAShameThatThe)
callnative(ClearMugshot)
closemessage

applymovement(PSFGOODBOSS,Common_Movement_WalkLeft)
waitmovement(0)

setvar(VAR_0x8000, MUGSHOT_GIOVANNI)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_ButBeatingYou)
callnative(ClearMugshot)
closemessage

trainerbattle_continue_after_lose(TRAINER_ARCHIE,gText_WhyAreYouHelpingThem_WaitAMinute)
goto(WhyAreYouHelpingThem_PostBattleBoss_Dialogue)
}

script WhyAreYouHelpingThem_PostBattleBoss_Dialogue{
    setvar(VAR_ROUTE118_STATE,4)

if (defeated(TRAINER_ARCHIE)){

setvar(VAR_0x8000, MUGSHOT_GIOVANNI)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_YoureIncredible)
closemessage
callnative(ClearMugshot)
applymovement(PSFGOODBOSS,Common_Movement_WalkInPlaceLeft)
waitmovement(0)
giveitem(ITEM_MASTER_BALL,1)

setvar(VAR_0x8000, MUGSHOT_GIOVANNI)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_AndNowWeHave)
}else {

setvar(VAR_0x8000, MUGSHOT_HILDA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_IDidntEvenTouch)
}

setvar(VAR_0x8000, MUGSHOT_GIOVANNI)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_ImSorryYouHad)
callnative(ClearMugshot)
closemessage

applymovement(PSFGOODBOSS,Common_Movement_WalkInPlaceLeft)
waitmovement(0)
callnative(HealPlayerParty)
call(WhyAreYouHelpingThem_MoveObjectPsfgoodadmin_Script)
applymovement(PSFGOODADMIN,WhyAreYouHelpingThem_WalkPastPlayer)
waitmovement(0)

setvar(VAR_0x8000, MUGSHOT_ARIANA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_IHandledTheBrat)
callnative(ClearMugshot)
closemessage

playse(SE_PIN)
waitse
applymovement(PSFGOODADMIN,WhyAreYouHelpingThem_ExclaimAndFacePlayer)
waitmovement(0)

setvar(VAR_0x8000, MUGSHOT_ARIANA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_DamnYouToo)

setvar(VAR_0x8000, MUGSHOT_HILDA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_WhatWasAllThatShit)

setvar(VAR_0x8000, MUGSHOT_GIOVANNI)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_WeveGotToHelp)

applymovement(PSFGOODBOSS,WhyAreYouHelpingThem_BeginEscape)
applymovement(PSFGOODADMIN,WhyAreYouHelpingThem_BeginEscape)
waitmovement(0)
goto(WhyAreYouHelpingThem_ExplodeWall_Script)
    }

script WhyAreYouHelpingThem_ExplodeWall_Script {

playse(SE_M_EXPLOSION)
waitse
setvar(VAR_0x8004,1)
setvar(VAR_0x8005,2)
setvar(VAR_0x8006,8)
setvar(VAR_0x8007,5)
special(ShakeCamera)
waitstate
call(WhyAreYouHelpingThem_BlowHoleWall)
clearflag(FLAG_HIDE_WHYAREYOU_NATIVERIVAL)
playse(SE_EXIT)
waitse
addobject(PSFNATIVERIVAL)
applymovement(PSFNATIVERIVAL,WhyAreYouHelpingThem_WalkOutOfHole)
waitmovement(0)

setvar(VAR_0x8000, MUGSHOT_HUGH)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_ThisPlaceIs)

setvar(VAR_0x8000, MUGSHOT_GIOVANNI)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_WeCantLeavePeople)

setvar(VAR_0x8000, MUGSHOT_HUGH)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_WeDontHaveTime)

setvar(VAR_0x8000, MUGSHOT_ARIANA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_IThinkTheyreRight)

setvar(VAR_0x8000, MUGSHOT_GIOVANNI)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_Sigh)
callnative(ClearMugshot)
closemessage
applymovement(PSFGOODBOSS,WhyAreYouHelpingThem_WalkOutOfHoleA)
applymovement(PSFGOODADMIN,WhyAreYouHelpingThem_WalkOutOfHoleB)
waitmovement(0)
playse(SE_EXIT)
waitse
removeobject(PSFGOODADMIN)
removeobject(PSFGOODBOSS)
    }
script leftover {

setvar(VAR_0x8000, MUGSHOT_HILDA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_YoureWorkingWith)

//Game prompts a save.

setvar(VAR_0x8000, MUGSHOT_HUGH)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_AlwaysHaveBeen)

//The player battles Psfnativerival.

//If the player wins:

setvar(VAR_0x8000, MUGSHOT_HUGH)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_AnotherVictory)

//Cut back to the overworld.

setvar(VAR_0x8000, MUGSHOT_HILDA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_TellsMeYoureAll)

setvar(VAR_0x8000, MUGSHOT_HUGH)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_WhyWouldIt)

setvar(VAR_0x8000, MUGSHOT_BIANCA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_Player)

//The player turns around as Psftransrival runs up behind them.

setvar(VAR_0x8000, MUGSHOT_BIANCA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_IGotKnockedOut)

setvar(VAR_0x8000, MUGSHOT_HILDA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_NoILostToo)

//The player turns around, and the camera pans up. Psftransrival is gone. The screen fades to black. The screen fades back in, to Chief Bill standing before the police squad, Psftransrival, and the player.

msgbox(gText_WhyAreYouHelpingThem_GreatWorkInThere)

//One officer steps forward.

msgbox(gText_WhyAreYouHelpingThem_WeSpottedAndTheir)

//The officer steps backward.

msgbox(gText_WhyAreYouHelpingThem_AShameStillWeveShutDown)

//Chief Bill walks over to the player.

msgbox(gText_WhyAreYouHelpingThem_NotBadInThere)

//Player regains control.

//Cutscene continues when the player enters the compound. Screen fades to black.

//INT. PSFCITY8 COMPOUND

//Psfbadadmin is standing in front of Psftransrival and the player.

setvar(VAR_0x8000, MUGSHOT_LANCE)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_WhatADay)

setvar(VAR_0x8000, MUGSHOT_HILDA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_ItWasADay)

setvar(VAR_0x8000, MUGSHOT_LANCE)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_GoodNewsWhileYouWere)

setvar(VAR_0x8000, MUGSHOT_BIANCA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_OhThatWasFast)

setvar(VAR_0x8000, MUGSHOT_LANCE)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_DontWorryAboutIt)

setvar(VAR_0x8000, MUGSHOT_LANCE)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_NowIveGotALot)

//Psfbadadmin walks out of the compound.

setvar(VAR_0x8000, MUGSHOT_BIANCA)
callnative(DrawMugshot)
msgbox(gText_WhyAreYouHelpingThem_WeveAllGot)

//Psftransrival walks out of the compound.

//Cutscene ends.

//If the player goes to sleep at this point:

msgbox(gText_WhyAreYouHelpingThem_AreYouReadyToBegin)

//If the player chooses Yes, they are warped to the Stadium and the next cutscene.

//If the player chooses No, a normal sleep cycle occurs.
}

text gText_WhyAreYouHelpingThem_StructuralBreach {
format("STRUCTURAL BREACH DETECTED. BASE IS NOW SHIFTING TO DEFENSE MODE. EVACUATE IMMEDIATELY.")
}

text gText_WhyAreYouHelpingThem_DefenseMode {
format("“Defense mode” is pretty advanced for some abandoned buildings.")
}

text gText_WhyAreYouHelpingThem_WeShouldRedefine {
format("We should redefine abandoned…")
}

text gText_WhyAreYouHelpingThem_LetsSplitUp {
format("Let's split up. I'm faster than you and can cut off the leaders before they escape.")
}

text gText_WhyAreYouHelpingThem_WhaFineIllTry {
format("wha - fine, I'll try to find the source of the hack and shut it down.")
}

text gText_WhyAreYouHelpingThem_SeeYa {
format("See ya.")
}

text gText_WhyAreYouHelpingThem_GoAfterIllHold {
format("Go after Psfgoodboss! I'll hold this one off.")
}

text gText_WhyAreYouHelpingThem_ItsAShameThatThe {
format("It's a shame that the cops have totally infiltrated our youth. ")
}

text gText_WhyAreYouHelpingThem_ButBeatingYou {
format("But beating you is going to be the best route out of here.")
}

text gText_WhyAreYouHelpingThem_WaitAMinute {
format("Wait a minute…")
}

text gText_WhyAreYouHelpingThem_YoureIncredible {
format("You're incredible. Or a cheater. Can't quite tell. Either way, you can have this.")
}

text gText_WhyAreYouHelpingThem_AndNowWeHave {
format("And now we have to act like I won.")
}

text gText_WhyAreYouHelpingThem_IDidntEvenTouch {
format("…I didn't even touch him…")
}

text gText_WhyAreYouHelpingThem_ImSorryYouHad {
format("I'm sorry you had to experience that. I hope you eventually understand what's at stake here, {PLAYER}. Let me help you.")
}

text gText_WhyAreYouHelpingThem_IHandledTheBrat {
format("I handled the brat. I'm guessing you beat -")
}

text gText_WhyAreYouHelpingThem_DamnYouToo {
format("Damn, you too, {PLAYER}?")
}

text gText_WhyAreYouHelpingThem_WhatWasAllThatShit {
format("What was all that shit you tried to tell me before?! What the hell is Psfgoodteam doing?")
}

text gText_WhyAreYouHelpingThem_WeveGotToHelp {
format("We've got to help more comrades escape. Another time.")
}

text gText_WhyAreYouHelpingThem_ThisPlaceIs {
format("This place is swarming with cops. You two need to get the hell out, right now. This goes straight out.")
}

text gText_WhyAreYouHelpingThem_WeCantLeavePeople {
format("We can't leave people behind. ")
}

text gText_WhyAreYouHelpingThem_WeDontHaveTime {
format("We don't have time for this! If you get arrested, this all falls apart! You. Need. To. Go.")
}

text gText_WhyAreYouHelpingThem_IThinkTheyreRight {
format("I think they're right.")
}

text gText_WhyAreYouHelpingThem_Sigh {
format("…*sigh*")
}

text gText_WhyAreYouHelpingThem_YoureWorkingWith {
format("You're working with Psfgoodteam too?!?")
}

text gText_WhyAreYouHelpingThem_AlwaysHaveBeen {
format("Always have been.")
}

text gText_WhyAreYouHelpingThem_AnotherVictory {
format("*sigh* Another victory for the establishment.")
}

text gText_WhyAreYouHelpingThem_TellsMeYoureAll {
format("Psfgoodadmin tells me you're all good guys… now all this shit? And you? None of this makes any sense!")
}

text gText_WhyAreYouHelpingThem_WhyWouldIt {
format("Why would it? You don't see what your bosses are doing to Psfregion1. You don't see what you're doing to Psfregion1.")
}

text gText_WhyAreYouHelpingThem_Player {
format("{PLAYER}!")
}

text gText_WhyAreYouHelpingThem_IGotKnockedOut {
format("I got knocked out. Did you stop Psfgoodboss?")
}

text gText_WhyAreYouHelpingThem_NoILostToo {
format("No, I lost too.")
}

text gText_WhyAreYouHelpingThem_GreatWorkInThere {
format("Great work in there, team. Andre, what's the sitrep regarding Psfgoodteam leadership?")
}

text gText_WhyAreYouHelpingThem_WeSpottedAndTheir {
format("We spotted Psfgoodboss and their lieutenant escaping on Pokemon by using the move Fly. We were unable to track them given our resources.")
}

text gText_WhyAreYouHelpingThem_AShameStillWeveShutDown {
format("A shame. Still, we've shut down their primary base of operations, and we arrested a bunch of these shitheads. This was an absolute win!")
}

text gText_WhyAreYouHelpingThem_NotBadInThere {
format("Not bad in there. Psfbadadmin wants you kids back at Psfcity8 Compound.")
}

text gText_WhyAreYouHelpingThem_WhatADay {
format("What… a day. I know that was a lot of pressure, but from what I hear, you were both fantastic. Thank you.")
}

text gText_WhyAreYouHelpingThem_ItWasADay {
format("…it was a day.")
}

text gText_WhyAreYouHelpingThem_GoodNewsWhileYouWere {
format("Good news - while you were training in Psfcave2, construction on Psfplace14 finished up. The Group Stage will start in 3 days. Hopefully, that's enough time to rest up and get ready.")
}

text gText_WhyAreYouHelpingThem_OhThatWasFast {
format("Oh, that was fast. How did you…")
}

text gText_WhyAreYouHelpingThem_DontWorryAboutIt {
format("Don't worry about it! You two just focus on winning! ")
}

text gText_WhyAreYouHelpingThem_NowIveGotALot {
format("Now, I've got a lot of work to do between now and then. I'll see you both in a few days!")
}

text gText_WhyAreYouHelpingThem_WeveAllGot {
format("We've all got some work to do! I'll see you around, {PLAYER}.")
}

text gText_WhyAreYouHelpingThem_AreYouReadyToBegin {
format("Are you ready to begin the Championship?")
}

movement WhyAreYouHelpingThem_PoliceRunIn {
    walk_left * 8
    step_end
}

movement WhyAreYouHelpingThem_FleeTheBattle {
    walk_up * 4
        step_end
}

movement WhyAreYouHelpingThem_ApproachPsfgoodboss {
    walk_up * 2
    walk_right * 4
}
